# Hybrid Search νλΌλ―Έν„° μµμ ν™” μ‹¤ν— κ²°κ³Ό

## π“ μ‹¤ν— κ°μ”

**λ©ν‘**: BM25 + Dense Retrieval + RRF + LLM Reranking νλΌλ―Έν„° μµμ ν™”λ¥Ό ν†µν• MAP@3 μ„±λ¥ ν–¥μƒ

**μ‹¤ν— μΌμ‹**: 2025-11-22

**κ²€μ¦ λ°©λ²•**: LLM μƒμ„± Ground Truth (126κ° μΏΌλ¦¬) κΈ°λ° λ΅μ»¬ κ²€μ¦

## π”¬ μ‹¤ν— μ„¤μ •

### Baseline (hybrid_final_solution.py)
- BM25 Top-K: 20
- Dense Top-K: 20
- RRF k: 60
- LLM Candidates: 15
- **λ΅μ»¬ MAP@3**: 0.9442
- **μ‹¤μ  MAP@3**: 0.7523

### μ‹¤ν— λ³€μ
1. **BM25/Dense Top-K**: 20 β†’ 30 β†’ 50
2. **LLM Candidates**: 15 β†’ 20 β†’ 30
3. **RRF k**: 30, 60, 90

## π“ μ‹¤ν— κ²°κ³Ό

| μμ„ | μ‹¤ν—λ… | BM25 Top-K | Dense Top-K | RRF k | LLM Cand | MAP@3 | AP>0.9 |
|------|--------|------------|-------------|-------|----------|-------|--------|
| 1 | **Baseline** | **20** | **20** | **60** | **15** | **0.9442** | **84.1%** |
| 2 | exp1_llm_more_candidates | 30 | 30 | 60 | 20 | 0.9127 | 77.8% |
| 3 | exp3_rrf_tighter | 30 | 30 | 30 | 20 | 0.9034 | 77.0% |
| 4 | exp4_rrf_looser | 30 | 30 | 90 | 20 | 0.9034 | 77.0% |
| 5 | exp5_balanced | 40 | 40 | 60 | 25 | 0.8649 | 69.0% |
| 6 | exp2_llm_max_candidates | 50 | 50 | 60 | 30 | 0.8142 | 62.7% |

## π” μ£Όμ” λ°κ²¬μ‚¬ν•­

### 1. Baselineμ΄ μµμ  μ„¤μ •
- **0.9442 MAP@3**λ΅ λ¨λ“  μ‹¤ν— μ¤‘ μµκ³  μ„±λ¥
- AP>0.9 λΉ„μ¨ 84.1%λ΅ μ••λ„μ 

### 2. νλΌλ―Έν„° μ¦κ°€μ μ—­ν¨κ³Ό
```
Top-K μ¦κ°€ ν¨κ³Ό:
- 20 β†’ 30: MAP 0.9442 β†’ 0.9127 (-0.0315, -3.3%)
- 20 β†’ 50: MAP 0.9442 β†’ 0.8142 (-0.1300, -13.8%)

LLM Candidates μ¦κ°€ ν¨κ³Ό:
- 15 β†’ 20: MAP 0.9442 β†’ 0.9127 (-0.0315)
- 15 β†’ 30: MAP 0.9442 β†’ 0.8142 (-0.1300)
```

**λ¶„μ„**: ν›„λ³΄κ°€ λ„λ¬΄ λ§μΌλ©΄ LLMμ΄ μ¬λ°”λ¥Έ λ¬Έμ„λ¥Ό μ„ νƒν•λ” λ° νΌλ€μ„ κ²μ

### 3. RRF kκ°’μ μν–¥ λ―Έλ―Έ
```
RRF k λ³€ν™” (BM25/Dense Top-30, LLM 20 κ³ μ •):
- k=30: MAP 0.9034
- k=60: MAP 0.9127
- k=90: MAP 0.9034

μ°¨μ΄: μµλ€ 0.0093 (1%)
```

**κ²°λ΅ **: RRF kκ°’μ€ 30-90 λ²”μ„μ—μ„ μ„±λ¥μ— ν° μν–¥ μ—†μ

### 4. AP λ¶„ν¬ λ¶„μ„

#### Baseline (μµμ )
```
AP=0.0:        1κ° (  0.8%)  β† κ±°μ μ—†μ
0.0<APβ‰¤0.3:    3κ° (  2.4%)
0.3<APβ‰¤0.6:   11κ° (  8.7%)
0.6<APβ‰¤0.9:    5κ° (  4.0%)
AP>0.9:      106κ° ( 84.1%)  β† μ••λ„μ 
```

#### exp2 (μµμ•…)
```
AP=0.0:        3κ° (  2.4%)  β† 3λ°° μ¦κ°€
0.0<APβ‰¤0.3:    8κ° (  6.3%)
0.3<APβ‰¤0.6:   28κ° ( 22.2%)  β† 2.5λ°° μ¦κ°€
0.6<APβ‰¤0.9:    8κ° (  6.3%)
AP>0.9:       79κ° ( 62.7%)  β† 27κ° κ°μ†
```

## π’΅ ν•µμ‹¬ μΈμ‚¬μ΄νΈ

### 1. "μ λ‹Ήν•¨μ΄ μµμ„ "
- λ„λ¬΄ λ§μ€ ν›„λ³΄ β†’ LLM νΌλ€ β†’ μ„±λ¥ μ €ν•
- μµμ  μ§€μ : BM25/Dense Top-20, LLM 15 candidates

### 2. LLMμ ν•κ³„
- 15κ° ν›„λ³΄μ—μ„ Top-3 μ„ νƒ: **μ μ‘λ™** (84.1% perfect)
- 30κ° ν›„λ³΄μ—μ„ Top-3 μ„ νƒ: **νΌλ€** (62.7% perfect)
- **21% μ„±λ¥ μ €ν•** λ°μƒ

### 3. Retrieval vs Reranking κ· ν•
```
BM25/Dense (Retrieval): 20κ° ν›„λ³΄ μƒμ„±
    β†“
RRF (Fusion): μ¤‘λ³µ μ κ±° λ° μµν•©
    β†“
LLM (Reranking): 15κ°μ—μ„ Top-3 μ„ νƒ
```

μ΄ νμ΄ν”„λΌμΈμ΄ κ°€μ¥ ν¨μ¨μ 

## β μ‹¤ν¨ν• κ°€μ„¤

### κ°€μ„¤ 1: "λ” λ§μ€ ν›„λ³΄ = λ” μΆ‹μ€ μ„±λ¥"
**κ²°κ³Ό**: β μ‹¤ν¨
- Top-50, LLM 30: 0.8142 (-13.8%)
- ν›„λ³΄κ°€ λ§μ„μλ΅ μ¤νλ ¤ μ„±λ¥ μ €ν•

### κ°€μ„¤ 2: "RRF kκ°’μ΄ μ¤‘μ”ν•λ‹¤"
**κ²°κ³Ό**: β λ³„ μ°¨μ΄ μ—†μ
- k=30 vs k=90: λ™μΌν• 0.9034
- RRFλ” robustnessκ°€ λ†’μ

## β… μµμΆ… κ¶μ¥ μ„¤μ •

```python
# μµμ  νλΌλ―Έν„°
BM25_TOP_K = 20
DENSE_TOP_K = 20
RRF_K = 60
LLM_CANDIDATES = 15

# μ„±λ¥
λ΅μ»¬ MAP@3: 0.9442 (LLM GT κΈ°μ¤€)
μ‹¤μ  MAP@3: 0.7523 (μ‚¬λ GT κΈ°μ¤€)
```

## π§ λ΅μ»¬ vs μ‹¤μ  μ μ Gap λ¶„μ„

### Gap ν¬κΈ°
```
λ΅μ»¬: 0.9442
μ‹¤μ : 0.7523
Gap:  0.1919 (20.3%)
```

### Gap μ›μΈ
1. **LLM Ground Truth νΈν–¥**
   - Solar-proκ°€ μƒμ„±ν• μ •λ‹µ β‰  μ‚¬λμ΄ λ§λ“  μ •λ‹µ
   - LLMμ΄ LLM μ •λ‹µμ„ λ§μ¶”λ” κ²ƒμ΄ λ” μ‰¬μ›€

2. **κ³Όμ ν•© μ„ν—**
   - LLM GTμ— μµμ ν™” β†’ μ‹¤μ  GTμ—λ” μ°¨μ„ μ±…

### ν•΄κ²° λ°©ν–¥
1. ~~νλΌλ―Έν„° νλ‹~~ (μ΄λ―Έ μµμ , λ” μ΄μƒ κ°μ„  λ¶κ°€)
2. **ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§** β† λ‹¤μ μ‹λ„
3. **λ‹¤λ¥Έ LLM λ¨λΈ** (GPT-4, Claude λ“±)
4. **μ•™μƒλΈ” μ „λµ**

## π“ λ‹¤μ λ‹¨κ³„

### Phase 1: ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§ (μ§„ν–‰ μ¤‘)
- ν„μ¬ ν”„λ΅¬ν”„νΈ λ¶„μ„
- Relevance κΈ°μ¤€ λ…ν™•ν™”
- Few-shot μμ‹ μ¶”κ°€
- Chain-of-Thought μ μ©

### Phase 2: λ€μ• νƒμƒ‰ (ν•„μ”μ‹)
- GPT-4o reranking μ‹λ„
- μ•™μƒλΈ” (Solar + GPT-4o)
- Cross-encoder fine-tuning

## π“ μ°Έκ³  μλ£

- [HYBRID_SUCCESS_ANALYSIS.md](HYBRID_SUCCESS_ANALYSIS.md): 0.7523 μ„±λ¥ λ¶„μ„
- [hybrid_final_solution.py](hybrid_final_solution.py): Baseline μ½”λ“
- [hybrid_experiments.py](hybrid_experiments.py): μ‹¤ν— μ½”λ“
- [validation_summary.json](validation_summary.json): μ „μ²΄ κ²€μ¦ κ²°κ³Ό
