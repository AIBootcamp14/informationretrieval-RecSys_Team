# RAG 시스템에서 적합한 문서 추출 평가 지표 지정하기

## 개요

RAG (Retrieval-Augmented Generation) 시스템은 **질의와 연관된 문서를
검색 엔진이나 데이터베이스에서 가져와 답변을 생성**하는 구조입니다.
따라서 답변 생성 이전 단계인 **문서 추출 과정**이 매우 중요하며, 이
단계가 정확했는지를 평가하는 지표가 필요합니다.

본 문서는 해당 대회에서 사용된 평가 방식과 MAP 지표의 변형 사용법을
정리합니다.

------------------------------------------------------------------------

## 1. 문서 추출 평가의 필요성

-   각 질의는 **하나 이상의 적합 문서**를 가질 수 있음\
-   과학 상식 기반 질문만 문서 추출 대상\
-   일반 대화・잡담 등 비과학 질문은 문서 추출 없이 답변해야 함

예시(문서 추출 필요 없음): - "안녕 반갑다" - "너 정말 똑똑하다!" - "너
잘하는 게 뭐야?"

------------------------------------------------------------------------

## 2. MAP (Mean Average Precision)의 변형 적용

원래 MAP은 **검색 결과의 순위 품질을 평가**하기 위한 지표입니다.\
하지만 본 대회에서는 아래와 같이 목적에 맞게 MAP을 **0 또는 1의 이진
지표로 변형**하여 사용합니다:

### ✔ 문서 추출이 필요 없는 질문

-   모델이 아무 문서도 추출하지 않음 → **MAP = 1 (올바른 판단)**\
-   하나라도 문서를 추출함 → **MAP = 0 (잘못된 판단)**

즉, 모델이 "이 질문은 과학 지식 기반 RAG가 필요하다 / 필요 없다"를
올바르게 구분하는지를 평가합니다.

------------------------------------------------------------------------

## 3. 다른 지표(MRR, NDCG)와의 비교

### MRR

-   첫 번째 정답의 위치만 평가\
-   → **복수 문서가 필요한 질문에는 부적합**

### NDCG

-   상위 순위의 품질을 평가\
-   하지만 활용하려면 문서별 **관련도 점수(graded relevance)**가 필요\
-   본 대회에서는 "관련 있음/없음"만 제공 → **활용 불가**

------------------------------------------------------------------------

## 4. MAP 사용의 최종 이유

-   복수 문서가 정답이 될 수 있으며\
-   문서별 연관도 점수도 제공되지 않기 때문에\
    → **MAP이 가장 적절한 지표**

현업에서도 RAG 파이프라인 평가 시 MAP, Precision, Recall 등을 함께
활용하는 경우가 많습니다.

------------------------------------------------------------------------

## 결론

-   문서 추출 여부 판단 및 RAG 시작 여부를 평가하기 위해 MAP를 변형하여
    사용\
-   "문서가 필요한 질문인가?"를 맞히는 것이 가장 중요\
-   복수 문서 기반 평가가 필요하므로 MRR보다 MAP이 적합

------------------------------------------------------------------------
